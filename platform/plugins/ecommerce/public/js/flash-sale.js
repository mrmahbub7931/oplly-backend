$(document).ready((function(){$(document).on("click",".list-search-data .selectable-item",(function(e){e.preventDefault();var a=$(e.currentTarget),t=a.closest(".form-group").find("input[type=hidden]"),n=[];if($.each(t.val().split(","),(function(e,a){a&&""!==a&&(n[e]=parseInt(a))})),$.inArray(a.data("id"),n)<0){t.val()?t.val(t.val()+","+a.data("id")):t.val(a.data("id"));var r=$(document).find("#selected_product_list_template").html().replace(/__name__/gi,a.data("name")).replace(/__id__/gi,a.data("id")).replace(/__index__/gi,n.length).replace(/__url__/gi,a.data("url")).replace(/__image__/gi,a.data("image")).replace(/__attributes__/gi,a.find("a span").text());a.closest(".form-group").find(".list-selected-products").removeClass("hidden"),a.closest(".form-group").find(".list-selected-products table tbody").append(r)}a.closest(".panel").addClass("hidden")})),$(document).on("click",".textbox-advancesearch",(function(e){var a=$(e.currentTarget),t=a.closest(".box-search-advance").find(".panel");t.removeClass("hidden"),t.addClass("active"),0===t.find(".panel-body").length&&(Canopy.blockUI({target:t,iconOnly:!0,overlayColor:"none"}),$.ajax({url:a.data("target"),type:"GET",success:function(e){e.error?Canopy.showError(e.message):(t.html(e.data),Canopy.unblockUI(t))},error:function(e){Canopy.handleError(e),Canopy.unblockUI(t)}}))})),$(document).on("keyup",".textbox-advancesearch",(function(e){var a=$(e.currentTarget),t=a.closest(".box-search-advance").find(".panel");setTimeout((function(){Canopy.blockUI({target:t,iconOnly:!0,overlayColor:"none"}),$.ajax({url:a.data("target")+"?keyword="+a.val(),type:"GET",success:function(e){e.error?Canopy.showError(e.message):(t.html(e.data),Canopy.unblockUI(t))},error:function(e){Canopy.handleError(e),Canopy.unblockUI(t)}})}),500)})),$(document).on("click",".box-search-advance .page-link",(function(e){e.preventDefault();var a=$(e.currentTarget);if(!a.closest(".page-item").hasClass("disabled")&&a.prop("href")){var t=a.closest(".box-search-advance").find(".panel");Canopy.blockUI({target:t,iconOnly:!0,overlayColor:"none"}),$.ajax({url:a.prop("href")+"&keyword="+a.val(),type:"GET",success:function(e){e.error?Canopy.showError(e.message):(t.html(e.data),Canopy.unblockUI(t))},error:function(e){Canopy.handleError(e),Canopy.unblockUI(t)}})}})),$(document).on("click","body",(function(e){var a=$(".box-search-advance");a.is(e.target)||0!==a.has(e.target).length||a.find(".panel").addClass("hidden")})),$(document).on("click",".btn-trigger-remove-selected-product",(function(e){e.preventDefault();var a=$(e.currentTarget).closest(".form-group").find("input[type=hidden]"),t=a.val().split(",");$.each(t,(function(e,a){a=a.trim(),_.isEmpty(a)||(t[e]=parseInt(a))}));var n=t.indexOf($(e.currentTarget).data("id"));n>-1&&t.splice(n,1),a.val(t.join(",")),$(e.currentTarget).closest("tbody").find("tr").length<2&&$(e.currentTarget).closest(".list-selected-products").addClass("hidden"),$(e.currentTarget).closest("tbody").find("tr[data-product-id="+$(e.currentTarget).data("id")+"]").remove()}))}));